import os
import requests
import geocoder

def print_banner():
    print("""
  _____     _ _     _       _             
 / ____|   (_) |   | |     | |            
| |  __  __ _| |__ | | ___ | |_ ___   ___ 
| | |_ |/ _` | '_ \| |/ _ \| __/ _ \ / _ \\
| |__| | (_| | |_) | | (_) | || (_) |  __/
 \_____|\__,_|_.__/|_|\___/ \__\___/ \___|

Welcome to my all-in-one pentesting tool!
Choose an option below:

1. IP Tools
2. Vulnerability Scanning Tools
3. Network Scanning Tools
4. Password Cracking Tools
5. Exit
""")

def main():
    while True:
        print_banner()
        choice = input("Enter an option: ")

        if choice == "1":
            ip_tools()
        elif choice == "2":
            vuln_scanning_tools()
        elif choice == "3":
            network_tools()
        elif choice == "4":
            password_cracking_tools()
        elif choice == "5":
            print("Exiting...")
            break
        else:
            print("Invalid option. Please choose again.")
 
def ip_tools():
    while True:
        print("IP Tools:")
        print("1. Geolocation")
        print("2. Ping")
        print("3. Traceroute")
        print("4. Back to Main Menu")

        choice = input("Enter an option: ")

        if choice == "1":
            geolocation()
        elif choice == "2":
            ping()
        elif choice == "3":
            traceroute()
        elif choice == "4":
            break
        else:
            print("Invalid option. Please choose again.")

           
def geolocation():
    ip_address = input("Enter an IP address: ")
    g = geocoder.ip(ip_address)
    
    if g.ok:
        print("Location details for IP address", ip_address)
        print("Latitude:", g.lat)
        print("Longitude:", g.lng)
        print("City:", g.city)
        print("Country:", g.country)
        print("ISP:", g.org)
    else:
        print("Failed to retrieve location details for IP address", ip_address)

def ping():
    ip_address = input("Enter an IP address: ")
    os.system(f"ping {ip_address}")
    
def traceroute():
    ip_address = input("Enter an IP address: ")
    os.system(f"traceroute {ip_address}")   

def vuln_scanning_tools():
    print("Vulnerability Scanning Tools:")
    print("1. Nmap")
    print("2. Nikto")
    print("3. Sqlmap")
    print("4. Back to Main Menu")

    while True:
        choice = input("Enter an option: ")

        if choice == "1":
       	    web_url = input("Enter the URL or IP to scan: ")
            os.system("sudo nmap -p- -sS -sV " + web_url)
        elif choice == "2":
            web_url = input("Enter the URL to scan: ")
            os.system("nikto -h " + web_url)
        elif choice == "3":
            sql_url = input("Enter the URL to scan: ")
            os.system("sqlmap -u " + sql_url)
        elif choice == "4":
            break
        else:
            print("Invalid option. Please choose again.")
            
def network_tools():
    print("Network Sniffing and Analysis Tools:")
    print("1. Wireshark")
    print("2. tcpdump")
    print("3. Back to Main Menu")

    while True:
        choice = input("Enter an option: ")

        if choice == "1":
            os.system("wireshark")
        elif choice == "2":
            os.system("tcpdump")
        elif choice == "3":
            break
        else:
            print("Invalid option. Please choose again.")
            
def password_cracking_tools():
    print("Password Cracking Tools:")
    print("1. John the Ripper")
    print("2. Hashcat")
    print("3. Hydra")
    print("4. Aircrack-ng")
    print("5. Back to Main Menu")

    while True:
        choice = input("Enter an option: ")

        if choice == "1":
            print("John the Ripper Options:")
            print("1. Select Wordlist")
            print("2. Select Hash File")
            print("3. Return to Password Cracking Tools Menu")
            john_choice = input("Enter an option: ")

            if john_choice == "1":
                wordlist = input("Enter the path to the wordlist file: ")
                hash_file = input("Enter the path to the hash file: ")
                os.system(f"john --wordlist={wordlist} {hash_file}")
            elif john_choice == "2":
                hash_file = input("Enter the path to the hash file: ")
                os.system(f"john --show {hash_file}")
            elif john_choice == "3":
                break
            else:
                print("Invalid option. Please choose again.")
                
        elif choice == "2":
            print("Hashcat Options:")
            print("1. Select Wordlist")
            print("2. Select Hash File")
            print("3. Return to Password Cracking Tools Menu")
            hashcat_choice = input("Enter an option: ")

            if hashcat_choice == "1":
                wordlist = input("Enter the path to the wordlist file: ")
                hash_file = input("Enter the path to the hash file: ")
                os.system(f"hashcat -m 0 {hash_file} {wordlist}")
            elif hashcat_choice == "2":
                hash_file = input("Enter the path to the hash file: ")
                os.system(f"hashcat --show {hash_file}")
            elif hashcat_choice == "3":
                break
            else:
                print("Invalid option. Please choose again.")

        elif choice == "3":
            print("Hydra Options:")
            print("1. SSH")
            print("2. Telnet")
            print("3. FTP")
            print("4. Return to Password Cracking Tools Menu")
            hydra_choice = input("Enter an option: ")

            if hydra_choice == "1":
                username = input("Enter the SSH username: ")
                password_file = input("Enter the path to the password file: ")
                target = input("Enter the target IP address: ")
                os.system(f"hydra -l {username} -P {password_file} {target} ssh")
            elif hydra_choice == "2":
                username = input("Enter the Telnet username: ")
                password_file = input("Enter the path to the password file: ")
                target = input("Enter the target IP address: ")
                os.system(f"hydra -l {username} -P {password_file} {target} telnet")
            elif hydra_choice == "3":
                username = input("Enter the FTP username: ")
                password_file = input("Enter the path to the password file: ")
                target = input("Enter the target IP address: ")
                os.system(f"hydra -l {username} -P {password_file} {target} ftp")
            elif hydra_choice == "4":
                break
            else:
                print("Invalid option. Please choose again.")

        elif choice == "4":
            print("Aircrack-ng Options:")
            print("1. Crack WEP")
            print("2. Crack WPA/WPA2")
            print("3. Return to Password Cracking Tools Menu")
            aircrack_choice = input("Enter an option: ")

            if aircrack_choice == "1":
                interface = input("Enter the name of your wireless interface: ")
                bssid = input("Enter the BSSID of the target network: ")
                wordlist = input("Enter the path to the wordlist file: ")
                os.system(f"aircrack-ng -a 1 -b {bssid} -w {wordlist} {interface}.cap")
            elif aircrack_choice == "2":
                interface = input("Enter the name of your wireless interface: ")
                bssid = input("Enter the BSSID of the target network: ")
                wordlist = input("Enter the path to the wordlist file: ")
                os.system(f"aircrack-ng -a 2 -b {bssid} -w {wordlist} {interface}.cap")
            elif aircrack_choice == "3":
                break
            else:
                print("Invalid option. Please choose again.")



main()    
